<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - MeatLizard AI Platform</title>
    <link href="/static/css/meatlizard.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="mascot">ðŸ¦Ž</div>
        <h1>MEATLIZARD AI PLATFORM</h1>
        <div class="subtitle">User Dashboard</div>
    </header>

    <!-- Navigation -->
    <nav>
        <a href="/">Home</a> |
        <a href="/dashboard" class="active">Dashboard</a> |
        <a href="/features">Features</a> |
        <span id="userGreeting" style="color: #ff8080;">Welcome!</span> |
        <a href="#" onclick="logout()" style="color: #ff4d4d;">Logout</a>
    </nav>

    <!-- Main Content -->
    <main>
        <h2>Your Dashboard</h2>
        <p>Access all MeatLizard platform features from your personal dashboard.</p>

        <div class="feature-grid">
            <!-- AI Chat -->
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="feature-title">AI Chat</div>
                <div class="feature-description">
                    Start conversations with powerful AI models running locally with Apple Metal acceleration.
                </div>
                <div class="text-center">
                    <a href="/chat" class="retro-button">Open Chat</a>
                </div>
            </div>

            <!-- URL Shortener -->
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-link"></i>
                </div>
                <div class="feature-title">URL Shortener</div>
                <div class="feature-description">
                    Create short, memorable links with detailed analytics and custom options.
                </div>
                <div class="text-center">
                    <a href="/url-shortener" class="retro-button">Shorten URL</a>
                </div>
            </div>

            <!-- Pastebin -->
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-paste"></i>
                </div>
                <div class="feature-title">Pastebin</div>
                <div class="feature-description">
                    Share code and text with syntax highlighting and privacy controls.
                </div>
                <div class="text-center">
                    <a href="/pastebin" class="retro-button">Create Paste</a>
                </div>
            </div>

            <!-- Video Platform -->
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-video"></i>
                </div>
                <div class="feature-title">Video Platform</div>
                <div class="feature-description">
                    Upload, transcode, and stream videos with automatic quality optimization.
                </div>
                <div class="text-center">
                    <a href="/video-upload" class="retro-button">Upload Video</a>
                </div>
            </div>

            <!-- Media Import -->
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-download"></i>
                </div>
                <div class="feature-title">Media Import</div>
                <div class="feature-description">
                    Import content from YouTube, TikTok, and other platforms using yt-dlp.
                </div>
                <div class="text-center">
                    <a href="/media-import" class="retro-button">Import Media</a>
                </div>
            </div>

            <!-- File Storage -->
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-folder"></i>
                </div>
                <div class="feature-title">File Storage</div>
                <div class="feature-description">
                    Manage your files with secure storage and sharing capabilities.
                </div>
                <div class="text-center">
                    <a href="/file-storage" class="retro-button">Browse Files</a>
                </div>
            </div>
        </div>

        <h2>Recent Activity</h2>
        <div class="card">
            <div class="card-header">
                <i class="fas fa-history"></i> Your Recent Activity
            </div>
            <div id="recentActivity">
                <div class="text-center">
                    <i class="fas fa-spinner fa-spin"></i> Loading recent activity...
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        &copy; 2024 MeatLizard Systems | Powered by raw meat and GPUs
    </footer>

    <script>
        // Check authentication
        const token = localStorage.getItem('access_token');
        const user = JSON.parse(localStorage.getItem('user') || '{}');
        
        if (!token) {
            window.location.href = '/login';
        } else {
            // Update greeting
            document.getElementById('userGreeting').textContent = `Welcome, ${user.username || 'User'}!`;
        }
        
        function logout() {
            localStorage.removeItem('access_token');
            localStorage.removeItem('user');
            window.location.href = '/';
        }
        
        // Load recent activity
        async function loadRecentActivity() {
            try {
                const response = await fetch('/api/user/activity', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const activities = await response.json();
                    const activityList = document.getElementById('recentActivity');
                    
                    if (activities.length === 0) {
                        activityList.innerHTML = `
                            <li class="px-6 py-4">
                                <div class="text-sm text-gray-400">
                                    No recent activity. Start using the platform to see your activity here!
                                </div>
                            </li>
                        `;
                    } else {
                        activityList.innerHTML = activities.map(activity => `
                            <li class="px-6 py-4">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-300">
                                        <i class="fas fa-${activity.icon} mr-2 text-${activity.color}-400"></i>
                                        ${activity.description}
                                    </div>
                                    <div class="text-xs text-gray-500">
                                        ${new Date(activity.timestamp).toLocaleDateString()}
                                    </div>
                                </div>
                            </li>
                        `).join('');
                    }
                } else {
                    document.getElementById('recentActivity').innerHTML = `
                        <li class="px-6 py-4">
                            <div class="text-sm text-gray-400">
                                Unable to load recent activity.
                            </div>
                        </li>
                    `;
                }
            } catch (error) {
                document.getElementById('recentActivity').innerHTML = `
                    <li class="px-6 py-4">
                        <div class="text-sm text-gray-400">
                            Unable to load recent activity.
                        </div>
                    </li>
                `;
            }
        }
        
        // Load activity on page load
        loadRecentActivity();
    </script>
</body>
</html>